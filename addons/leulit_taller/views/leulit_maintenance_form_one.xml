<?xml version='1.0' encoding='utf-8'?>
<odoo>
    <data>
        
        <record id="leulit_20230706_1118_form" model="ir.ui.view">
            <field name="name">leulit_20230706_1118_form</field>
            <field name="model">leulit.maintenance_form_one</field>
            <field name="arch" type="xml">
                <form string="Form One" create="false">
                    <header>
                        <button name="set_estado_firmado" string="Firmar IT" type="object" class="oe_highlight"  invisible="((estado != 'borrador'))"  groups="leulit.RolIT_developer"/>
                        <button name="set_estado_borrador" string="Pendiente IT" type="object" class="oe_highlight"  invisible="((estado == 'borrador'))"  groups="leulit.RolIT_developer"/>
                        <button name="set_estado_pendiente_firma" string="Firmar" type="object" class="oe_highlight"  invisible="((estado != 'borrador'))" />
                        <button name="print_form_one" string="Imprimir" type="object" class="oe_highlight"/>
                        <field name="estado" widget="statusbar"/>
                    </header>
                    <sheet>
                        <group col="4">
                            <field name="tracking_number"  readonly="((estado != 'borrador'))" />
                            <field name="work_order_id"  readonly="((estado != 'borrador'))"  options="{'no_create': True, 'edit': False, 'no_open':true}"/>
                            <field name="task_id"  readonly="((estado != 'borrador'))"  options="{'no_create': True, 'edit': False, 'no_open':true}"/>
                            <field name="status_work"  readonly="((estado != 'borrador'))" />
                        </group>
                        <field name="items_ids"  readonly="((estado != 'borrador'))" >
                            <tree editable="bottom">
                                <field name="item"/>
                                <field name="pieza_id" options="{'no_create': True, 'edit': False, 'no_open':true}"/>
                                <field name="qty"/>
                                <field name="move_created" invisible="1"/>
                                <field name="estado" invisible="1"/>
                                <button name="do_move_certificate" string="Movimiento certificado" type="object" class="oe_highlight"  invisible="((estado == 'borrador') or (move_created))" />
                            </tree>
                        </field>
                        <group>
                            <field name="template_id" options="{'no_create': True, 'edit': False, 'no_open':true}"/>
                            <field name="remarks" widget="html"  readonly="((estado != 'borrador'))" />
                        </group>
                        <group col="4" name="last_info_formone">
                            <field name="part_45"  readonly="((estado != 'borrador'))" />
                            <field name="certificador"  readonly="((estado != 'borrador'))"  options="{'no_create': True, 'edit': False, 'no_open':true}"/>
                            <field name="other_regulation"  readonly="((estado != 'borrador'))" />
                            <field name="fecha"  readonly="((estado != 'borrador'))" />
                        </group>
                    </sheet>
                    <div class="oe_chatter">
                        <field name="message_follower_ids" widget="mail_followers"/>
                        <field name="message_ids" widget="mail_thread"/>
                    </div>
                </form>
            </field>
        </record>
    
        <record id="leulit_20230706_1118_tree" model="ir.ui.view">
            <field name="name">leulit_20230706_1118_tree</field>
            <field name="model">leulit.maintenance_form_one</field>
            <field name="arch" type="xml">
                <tree string="Form One" create="false">
                    <field name="tracking_number"/>
                    <field name="work_order_id"/>
                    <field name="status_work"/>
                    <field name="fecha"/>
                    <field name="certificador"/>
                    <field name="estado"/>
                </tree>
            </field>
        </record>

	    <record model="ir.actions.act_window" id="leulit_20230706_1118_action">
            <field name="name">Forms One</field>
            <field name="res_model">leulit.maintenance_form_one</field>
            <field name="view_mode">tree,form</field>
        </record>
        

        <record id="paperformat_A4_landscape_form_one" model="report.paperformat">
            <field name="name">A4 Landscape certificados form one</field>
            <field name="format">A4</field>
            <field name="orientation">Landscape</field>
            <field name="margin_top">2</field>
            <field name="margin_bottom">0</field>
            <field name="margin_left">10</field>
            <field name="margin_right">16</field>
            <field name="header_line" eval="False"/>
            <field name="header_spacing">0</field>
            <field name="dpi">90</field>
        </record>

        <!-- REPORT FORM ONE -->
        <report
            id="leulit_20230706_1118_report"
            string="Form One"
            model="leulit.maintenance_form_one"
            report_type="qweb-pdf"
            file="leulit_taller.leulit_20230706_1118_informe"
            name="leulit_taller.leulit_20230706_1118_informe"
            paperformat="leulit_taller.paperformat_A4_landscape_form_one"
        />

        <template id="formone_report_header">
            <table class="fullwidth noborde">
                <tr class="noborde">
                    <th class="noborde">
                        <table class="noborde">
                            <tr>
                                <td class="noborde" style="font-size:8px; white-space: nowrap; text-align:center">(c) Icarus Manteniment</td>
                                <td class="noborde" style="font-size:8px; white-space: nowrap; text-align:center">
                                    <i style="font-size:8px;">Fecha creación documento</i><br/>
                                    <i><span style="font-size:8px;" t-esc="formone['fecha']"/></i>
                                </td>
                                <td class="noborde" style="font-size:8px; white-space: nowrap; text-align:center">
                                    <t t-if="hashcode">
                                        <i style="font-size:8px;">Firmado por:</i><br/>
                                        <i><span style="font-size:8px;" t-esc="firmado_por"/></i>
                                    </t>
                                </td>
                                <td class="noborde" style="font-size:8px; white-space: nowrap; text-align:center">
                                    <t t-if="hashcode">
                                        <i style="font-size:8px;">CSV/CID</i><br/>
                                        <span style="font-size:8px;" t-esc="hashcode"/>
                                    </t>
                                    <t t-if="not hashcode">
                                        <i style="font-size:8px;">Referencia</i><br/>
                                        <span style="font-size:8px;" t-esc="hashcode_interno"/>
                                    </t>
                                </td>
                            </tr>
                        </table>
                    </th>
                    <th class="noborde">
                        <table align="right">
                            <tr>
                                <td style="white-space: nowrap; text-align:center" class="noborde"><b style="font-size:8px;">Código:</b></td>
                                <td style="font-size:8px; white-space: nowrap; text-align:center" class="noborde">HLP-DOC-0010</td>
                                <td style="white-space: nowrap; text-align:center" class="noborde"><b style="font-size:8px;">Versión:</b></td>
                                <td style="font-size:8px; white-space: nowrap; text-align:center" class="noborde">1.1.0</td>
                            </tr>
                        </table>
                    </th>
                </tr>
                <tr class="noborde">
                    <th class="noborde" colspan="2" style="border-top: 1px solid #575757;">
                        <table class="fullwidth noborde" style="margin-bottom: 15px">
                            <tbody>
                                <tr class="noborde">
                                    <td colspan="2" class="noborde" style="font-size:8px;width:100%; text-align:center">
                                        Cualquier copia total o parcial de este documento se considera copia no controlada y siempre deberá ser contrastada con la información vigente en la intranet. (https://erp.helipistas.com/verifycsv)
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </th>
                </tr>
            </table>
        </template>   


        <template id="form_one_report_css">
            <style>
                html {
                    font-family: sans-serif; /* 1 */
                    -ms-text-size-adjust: 100%; /* 2 */
                    -webkit-text-size-adjust: 100%; /* 2 */
                }
                * {
                    margin: 0;
                    padding: 0;
                    font-size: 12px;
                }
                .fullwidth {
                    width: 100%;
                    border-collapse: collapse;
                    border: 2px solid black;
                }
                .noborde {
                    border: 0px none;
                }
                tr{
                    border: 2px solid black;
                }
                td{
                    border: 2px solid black;
                    padding: 10px;
                }
                .title_td{
                    text-align: center;
                }
            </style>
        </template>

        <template id="leulit_20230706_1118_informe">
            <t t-call="web.html_container">
                <t t-call="leulit_taller.form_one_report_css"/>
                <t t-set="cont" t-value="1"/>
                <t t-foreach="formonelist" t-as="formone">
                    <div class="watermark" style="position:absolute;opacity:0.25;font-size:1em;width:10%;text-align:left;z-index:9999;">
                        <img t-att-src="'data:image/png;base64,'+ watermark"/>
                    </div>
                    <t t-call="leulit_taller.formone_report_header" />
                    <table class="fullwidth">
                        <tr>
                            <td style="width:26%;">
                                <span>1. Approving Competent Authority / Country</span><br/><br/>
                                <span style="margin-left: 32%;"><b>AESA / SPAIN</b></span><br/><br/>
                            </td>
                            <td class="title_td" style="width:51%;" colspan="2">
                                <span><b>2. AUTHORISED RELEASE CERTIFICATE <br/> EASA FORM 1</b></span>
                            </td>
                            <td>
                                <span>3. Form Tracking Number</span><br/><br/>
                                <span t-esc="formone['tracking_number']"/><br/><br/>
                            </td>
                        </tr>
                        <tr>
                            <td style="border-right:0px">
                                <span>4. Organisation Name and Address:</span><br/><br/>
                                <span style="margin-left: 35%;"><b>ES.145.173</b></span><br/><br/>
                            </td>
                            <td style="border-left:0px;border-right:0px;text-align:right;">
                                <img t-att-src="'data:image/png;base64,%s' % to_text(logo)" style="width:auto;height:30px;"/>
                            </td>
                            <td style="border-left:0px;text-align:left;">
                                <pre><b>Icarus Manteniment, S.L.
Heliport Teresa Vilà
08231 Ullastrell, Barcelona</b></pre>
                            </td>
                            <td>
                                <span>5. Work Order/Contract/Invoice:</span><br/><br/>
                                <span t-esc="formone['work_order_id']"/><br/><br/>
                            </td>
                        </tr>
                    </table>
                    <table class="fullwidth" style="border-top:0px;">
                        <tr style="border-top:0px;">
                            <td style="border-top:0px; width:14%;">
                                <span>6. Item</span>
                            </td>
                            <td style="border-top:0px; width:15%;">
                                <span>7. Description</span>
                            </td>
                            <td style="border-top:0px; width:15%;">
                                <span>8. Part No.</span>
                            </td>
                            <td style="border-top:0px; width:15%;">
                                <span>9. Qty.</span>
                            </td>
                            <td style="border-top:0px; width:196px;">
                                <span>10. Serial No.</span>
                            </td>
                            <td style="border-top:0px;">
                                <span>11. Status/Work</span>
                            </td>
                        </tr>
                        <tr style="height:100px">
                            <td style="border-top:0px; width:14%;">
                                <t t-foreach="formone['items']" t-as="item">
                                    <span t-esc="item['item']"/><br/>
                                </t>
                            </td>
                            <td style="border-top:0px; width:15%;">
                                <t t-foreach="formone['items']" t-as="item">
                                    <span t-esc="item['descripcion_pieza']"/><br/>
                                </t>
                            </td>
                            <td style="border-top:0px; width:15%;">
                                <t t-foreach="formone['items']" t-as="item">
                                    <span t-esc="item['pn']"/><br/>
                                </t>
                            </td>
                            <td style="border-top:0px; width:15%;">
                                <t t-foreach="formone['items']" t-as="item">
                                    <span t-esc="item['qty']"/><br/>
                                </t>
                            </td>
                            <td style="border-top:0px; width:196px;">
                                <t t-foreach="formone['items']" t-as="item">
                                    <span t-esc="item['sn']"/><br/>
                                </t>
                            </td>
                            <td style="border-top:0px;">
                                <t t-foreach="formone['items']" t-as="item">
                                    <span t-esc="item['status_work']"/><br/>
                                </t>
                            </td>
                        </tr>
                    </table>
                    <table class="fullwidth" style="border-top:0px;">
                        <tr style="border-top:0px;">
                            <td colspan="4" style="border-top:0px;">
                                <span>12. Remarks</span><br/>
                                <div style="padding-left:20px;padding-right:20px;padding-top:5px;padding-bottom:5px;">
                                    <span t-raw="formone['remarks']"/>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td colspan="2" style="width:50%;background-color:#D9D9DA;">
                                <span>13a. Certifies that the items identified above were manufactured in conformity to:</span><br/>
                                <div style="padding-left:40px;padding-top:7px;padding-bottom:7px;">
                                    <span>□ approved design data and are in a condition for safe operation</span><br/>
                                </div>
                                <div style="padding-left:40px;">
                                    <span>□ non-approved design data specified in block 12</span><br/>
                                </div><br/><br/>
                            </td>
                            <td colspan="2">
                                <pre style="line-height: 200%">14a. <span style="border:1px solid grey; width:10px; height:10px;"><t t-if="formone['part_45']"> X </t><t t-else="">    </t></span> Part-145.A.50 Release to Service <span style="border:1px solid grey; width:10px; height:10px;"><t t-if="formone['other_regulation']"> X </t><t t-else="">    </t></span> Other regulation specified in block 12
Certifies that unless otherwise specified in block 12, the work identified in block 11 and 
described in block 12, was accomplished in accordance with Part-145 and in respect to 
that work the items are considered ready for release to service.</pre>
                            </td>
                        </tr>
                        <tr>
                            <td style="width:25%;background-color:#D9D9DA;">
                                <span>13b. Authorised Signature</span><br/><br/>
                            </td>
                            <td style="width:25%;background-color:#D9D9DA;">
                                <span>13c. Approval/Authorisation Number</span><br/><br/>
                            </td>
                            <td style="width:25%;">
                                <span>14b. Authorised Signature</span><br/>
                                <img t-att-src="'data:image/png;base64,%s' % to_text(formone['firma'])" style="width:auto;height:20px;"/>
                                <img t-att-src="'data:image/png;base64,%s' % to_text(formone['sello'])" style="width:auto;height:30px;"/>
                            </td>
                            <td style="width:25%;">
                                <span>14c. Certificate/Approval Ref. No.</span><br/>
                                <span style="margin-left: 30%;"><b>ES.145.173</b></span>
                            </td>
                        </tr>
                        <tr>
                            <td style="width:25%;background-color:#D9D9DA;">
                                <span>13d. Name</span><br/><br/>
                            </td>
                            <td style="width:25%;background-color:#D9D9DA;">
                                <span>13e. Date (dd mmm yyyy)</span><br/><br/>
                            </td>
                            <td style="width:25%;">
                                <span>14d. Name</span><br/>
                                <div style="padding-left:20px;">
                                    <span t-esc="formone['certificador']"/>
                                </div>
                            </td>
                            <td style="width:25%;">
                                <span>14e. Date (dd mmm yyyy)</span><br/>
                                <div style="padding-left:20px;">
                                    <span t-esc="formone['fecha']"/>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td colspan="4">
                                <pre>USER/INSTALLER RESPONSIBILITIES
This certificate does not automatically constitute authority to install the item(s).
Where the user/installer performs work in accordance with regulations of an airworthiness authority different than the airworthiness authority specified in block 1, it is essential that the user/
installer ensures that his/her airworthiness authority accepts items from the airworthiness authority specified in block 1.
Statements in blocks 13a and 14a do not constitute installation certification. In all cases aircraft maintenance records must contain an installation certification issued in accordance with the
national regulations by the user/installer before the aircraft may be flown.</pre>
                            </td>
                        </tr>
                    </table>
                    <t t-if="cont == num_pages">
                        <b>EASA Form 1 -MF/CAO/145 Issue 3</b>
                    </t>
                    <t t-else="">
                        <b>EASA Form 1 -MF/CAO/145 Issue 3</b>
                        <div style="page-break-after: always;"></div>
                    </t>
                    <t t-set="cont" t-value="cont+1"/>
                </t>
            </t>
        </template>


        <record id="leulit_mail_camo_formone_firmado" model="mail.template">
            <field name="name">Helipistas mail informa Form One firmado CAMO</field>
            <field name="email_from">erp@helipistas.com</field>
            <field name="email_to">${ctx.get('mail_to')}</field>
            <field name="model_id" ref="model_leulit_maintenance_form_one" />
            <field name="auto_delete" eval="True" />
            <field name="subject">${ctx.get('subject')}</field>
            <field name="body_html"><![CDATA[
                <table>
                    <tr>
                        <td>
                            Form One:
                        </td>
                        <td>
                            ${object.tracking_number}
                        </td>
                    </tr>
                    <tr>
                        <td>
                            Work Order:
                        </td>
                        <td>
                            ${object.work_order_id.name}
                        </td>
                    </tr>
                </table>
            ]]>
            </field>
        </record>


    </data>
</odoo>